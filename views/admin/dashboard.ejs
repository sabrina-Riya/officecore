<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; padding:20px; }
    h2 { margin-bottom:20px; color:#333; }
    a { text-decoration:none; color:inherit; }
    .top-links { margin-bottom:20px; }
    .top-links a { margin-right:15px; color:#007bff; font-weight:bold; }
    .cards { display:grid; grid-template-columns:repeat(auto-fit, minmax(140px,1fr)); gap:20px; margin-bottom:40px; }
    .card { background:#fff; padding:20px; border-radius:8px; text-align:center; box-shadow:0 2px 6px rgba(0,0,0,0.1); transition: transform 0.2s ease, box-shadow 0.2s ease; }
    .card:hover { transform:translateY(-4px); box-shadow:0 6px 14px rgba(0,0,0,0.15); }
    .card h3 { margin-bottom:10px; font-size:15px; color:#555; }
    .card p { font-size:26px; font-weight:bold; color:#111; margin:0; }
    table { width:100%; border-collapse:collapse; background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    th, td { padding:12px; border-bottom:1px solid #eee; text-align:left; }
    th { background:#fafafa; font-weight:bold; }
    .view-all { margin-top:15px; text-align:right; }
    .view-all a { color:#007bff; font-weight:bold; }
    footer { margin-top:40px; color:#666; text-align:center; }
  </style>
</head>
<body>

<div class="top-links">
  <a href="/logout">Logout</a>
  <a href="/admin/users">Users</a>
  <a href="/admin/leave">Manage Leaves</a>
  <a href="/admin/audit_logs">Audit Logs</a>
</div>

<h2>Welcome, <%= typeof adminName !== 'undefined' ? adminName : 'Admin' %></h2>

<div class="cards">
  <a href="/admin/users" class="card">
    <h3>Total Employees</h3>
    <p><%= totalUsers %></p>
  </a>
  <a href="/admin/leave?status=pending" class="card">
    <h3>Pending Leave Requests</h3>
    <p><%= pendingLeave %></p>
  </a>
  <a href="/admin/leave?status=approved" class="card">
    <h3>Approved Leaves</h3>
    <p><%= approvedLeave %></p>
  </a>
  <a href="/admin/leave?status=rejected" class="card">
    <h3>Rejected Leaves</h3>
    <p><%= rejectedLeave %></p>
  </a>
  <a href="/admin/audit_logs" class="card">
    <h3>Audit Logs</h3>
    <p>View</p>
  </a>
</div>

<h3>Recent Pending Leave Requests</h3>

<% if (!recentPendingLeave || recentPendingLeave.length === 0) { %>
  <p>No pending leave requests.</p>
<% } else { %>
  <table>
    <thead>
      <tr>
        <th>Employee</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th>Reason</th>
        <th>Requested At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% recentPendingLeave.forEach(req => { %>
        <tr>
          <td><%= req.employee_name %></td>
          <td><%= new Date(req.start_date).toLocaleDateString() %></td>
          <td><%= new Date(req.end_date).toLocaleDateString() %></td>
          <td><%= req.reason %></td>
          <td><%= new Date(req.created_at).toLocaleString() %></td>
          <td>
            <a href="/admin/leave/<%= req.id %>">View Details</a>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <div class="view-all">
    <a href="/admin/leave?status=pending">View all pending requests →</a>
  </div>
<% } %>

<!-- Flash Messages -->
<% if (success_msg && success_msg.length > 0) { %>
  <div style="background:#d4edda; color:#155724; padding:10px; margin:10px 0; border-radius:4px;">
    <%= success_msg %>
  </div>
<% } %>

<% if (err_msg && err_msg.length > 0) { %>
  <div style="background:#f8d7da; color:#721c24; padding:10px; margin:10px 0; border-radius:4px;">
    <%= err_msg %>
  </div>
<% } %>

<footer>© 2025 OfficeCore</footer>
</body>
</html>
