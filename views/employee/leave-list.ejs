<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Employee Leave List</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f6f8;
      padding: 40px;
    }
    h2 { color: #333; margin-bottom: 20px; }
    table {
      width: 100%;
      max-width: 900px;
      border-collapse: collapse;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    th, td { padding: 12px; border-bottom: 1px solid #ddd; }
    th { background-color: #007bff; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }

    .status-pending { color: orange; font-weight: bold; }
    .status-approved { color: green; font-weight: bold; }
    .status-rejected { color: red; font-weight: bold; }
    .status-cancelled { color: gray; font-weight: bold; }

    .actions { font-size: 14px; color: #555; }
    a { text-decoration: none; color: #007bff; margin-right: 15px; }
  </style>
</head>

<body>

<h2>Your Employee Leave List</h2>

<% if (leave.length === 0) { %>
  <div>No record of leave application found.</div>
<% } else { %>

<table>
  <tr>
    <th>ID</th>
    <th>Start Date</th>
    <th>End Date</th>
    <th>Reason</th>
    <th>Status</th>
    <th>Applied On</th>
    <th>Action</th>
  </tr>

  <% leave.forEach(item => { %>
    <tr>
      <td><%= item.id %></td>
      <td><%= item.start.toDateString() %></td>
      <td><%= item.end.toDateString() %></td>
      <td><%= item.reason %></td>

      <td class="status-<%= item.status %>">
        <%= item.status %>
      </td>

      <td><%= item.created_at.toDateString() %></td>

      <td class="actions">

        <% if (item.status === 'pending') { %>

          <form action="/employee/leave/cancel/<%= item.id %>" method="post">
            <button type="submit">Cancel Request</button>
          </form>

        <% } else if (item.status === 'cancelled') { %>

          Cancelled by you

        <% } else { %>

          By: <%= item.approved_by %><br>

          <% if (item.actioned_at) { %>
            On: <%= item.actioned_at.toDateString() %>
          <% } %>

          <% if (item.status === 'rejected') { %>
            <br>Reason: <%= item.rejection_reason %>
          <% } %>

        <% } %>

      </td>
    </tr>
  <% }) %>

</table>

<% } %>

<a href="/employee/leave-apply">Apply for Leave</a>
<a href="/employee/dashboard">Back to Dashboard</a>

</body>
</html>
